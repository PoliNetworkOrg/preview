<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-infrastructure/Guides/add-a-new-secret" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.7.0"><title data-rh=true>Add a New Secret | PoliNetwork Docs</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content=https://docs.polinetwork.org/preview/PoliNetworkOrg/docs/pr/32/img/docusaurus-social-card.jpg><meta data-rh=true name=twitter:image content=https://docs.polinetwork.org/preview/PoliNetworkOrg/docs/pr/32/img/docusaurus-social-card.jpg><meta data-rh=true property=og:url content=https://docs.polinetwork.org/preview/PoliNetworkOrg/docs/pr/32/docs/infrastructure/Guides/add-a-new-secret><meta data-rh=true property=og:locale content=en><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="Add a New Secret | PoliNetwork Docs"><meta data-rh=true name=description content=Introduction><meta data-rh=true property=og:description content=Introduction><link data-rh=true rel=icon href=/preview/PoliNetworkOrg/docs/pr/32/img/favicon.ico><link data-rh=true rel=canonical href=https://docs.polinetwork.org/preview/PoliNetworkOrg/docs/pr/32/docs/infrastructure/Guides/add-a-new-secret><link data-rh=true rel=alternate href=https://docs.polinetwork.org/preview/PoliNetworkOrg/docs/pr/32/docs/infrastructure/Guides/add-a-new-secret hreflang=en><link data-rh=true rel=alternate href=https://docs.polinetwork.org/preview/PoliNetworkOrg/docs/pr/32/docs/infrastructure/Guides/add-a-new-secret hreflang=x-default><link rel=stylesheet href=/preview/PoliNetworkOrg/docs/pr/32/assets/css/styles.466107e6.css><script src=/preview/PoliNetworkOrg/docs/pr/32/assets/js/runtime~main.3120941c.js defer></script><script src=/preview/PoliNetworkOrg/docs/pr/32/assets/js/main.27a6bf7c.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/preview/PoliNetworkOrg/docs/pr/32/img/logo.png><div role=region aria-label="Skip to main content"><a class=skipToContent_Fsmc href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/preview/PoliNetworkOrg/docs/pr/32/><div class=navbar__logo><img src=/preview/PoliNetworkOrg/docs/pr/32/img/logo.png alt="My Site Logo" class="themedComponent_zUZC themedComponent--light_CT2v"><img src=/preview/PoliNetworkOrg/docs/pr/32/img/logo.png alt="My Site Logo" class="themedComponent_zUZC themedComponent--dark_OfKI"></div><b class="navbar__title text--truncate">PoliNetwork Docs</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/preview/PoliNetworkOrg/docs/pr/32/docs/infrastructure/Introduction>Infrastructure</a><a class="navbar__item navbar__link" href=/preview/PoliNetworkOrg/docs/pr/32/docs/app/>Polifemo (deprecated)</a></div><div class="navbar__items navbar__items--right"><a href=https://github.com/polinetworkorg/docs target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_JuDX><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><div class="toggle_YPDd colorModeToggle_fFoU"><button class="clean-btn toggleButton_C59E toggleButtonDisabled_UtnK" type=button disabled title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live=polite aria-pressed=false><svg viewBox="0 0 24 24" width=24 height=24 class=lightToggleIcon_jiPC><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 class=darkToggleIcon_XSPo><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg></button></div><div class=navbarSearchContainer_A49B><div class="navbar__search searchBarContainer_gVP_" dir=ltr><input placeholder=Search aria-label=Search class="navbar__search-input searchInput_qqox" value=""><div class="loadingRing_yl6n searchBarLoadingRing_jFqM"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_Z27m"><div class=docsWrapper_vlky><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_MNT3" type=button></button><div class=docRoot_HErd><aside class="theme-doc-sidebar-container docSidebarContainer_H4WQ"><div class=sidebarViewport_eU3U><div class=sidebar_I2KC><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_y4Cd"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/preview/PoliNetworkOrg/docs/pr/32/docs/infrastructure/Introduction>Intro</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/preview/PoliNetworkOrg/docs/pr/32/docs/infrastructure/getting-started/setup>Getting Started</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href=/preview/PoliNetworkOrg/docs/pr/32/docs/infrastructure/Guides/add-a-new-secret>Guides</a></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/preview/PoliNetworkOrg/docs/pr/32/docs/infrastructure/Guides/add-a-new-secret>Add a New Secret</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/preview/PoliNetworkOrg/docs/pr/32/docs/infrastructure/Guides/deploy-a-new-app>Deploy a New App</a></ul></ul></nav></div></div></aside><main class=docMainContainer_QuaD><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_JsI3"><div class=docItemContainer_U1cf><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_ECxp" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/preview/PoliNetworkOrg/docs/pr/32/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_ibyY><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>Guides</span><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>Add a New Secret</span><meta itemprop=position content=2></ul></nav><div class="tocCollapsible_fHwV theme-doc-toc-mobile tocMobile_s_LV"><button type=button class="clean-btn tocCollapsibleButton_tMrf">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Add a New Secret</h1></header><h2 class="anchor anchorWithStickyNavbar_W4sa" id=introduction>Introduction<a href=#introduction class=hash-link aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<p>Secrets are used to configure deployments with <strong>sensitive</strong> data like database login, API keys, and so on.<br>
<!-- -->We have deployed a "Azure Key vault" (the "KV") named "kv-polinetwork" that stores all the secrets.<br>
<!-- -->Next, we can pass a secret from the KV to the k8s pod using a <code>SecretProviderClass</code>.</p>
<p>The following sections explain how to add a new secret.</p>
<h2 class="anchor anchorWithStickyNavbar_W4sa" id=basics>Basics<a href=#basics class=hash-link aria-label="Direct link to Basics" title="Direct link to Basics">​</a></h2>
<p>There are three required steps:</p>
<ol>
<li>Add the secret into the "KV"</li>
<li>Create and configure a <code>SecretProviderClass</code></li>
<li>Mount the secret volume inside the pod</li>
</ol>
<div class="theme-admonition theme-admonition-tip admonition_w9oP alert alert--success"><div class=admonitionHeading_aHcJ><span class=admonitionIcon_VWzO><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>tip</div><div class=admonitionContent_bAd8><p>Whenever there is <code>&lt;something></code> in the code or in a command, that's a paramter you need to set.</div></div>
<h3 class="anchor anchorWithStickyNavbar_W4sa" id=add-the-secret-into-the-kv>Add the secret into the "KV"<a href=#add-the-secret-into-the-kv class=hash-link aria-label='Direct link to Add the secret into the "KV"' title='Direct link to Add the secret into the "KV"'>​</a></h3>
<p>See <a href=#add-or-update-a-secret>this section</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_W4sa" id=create-the-secretproviderclass>Create the <code>SecretProviderClass</code><a href=#create-the-secretproviderclass class=hash-link aria-label="Direct link to create-the-secretproviderclass" title="Direct link to create-the-secretproviderclass">​</a></h3>
<p>References:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/aks/csi-secrets-store-identity-access?tabs=azure-portal&pivots=access-with-a-user-assigned-managed-identity" target=_blank rel="noopener noreferrer">Microsoft Guide</a></li>
<li><a href=https://secrets-store-csi-driver.sigs.k8s.io target=_blank rel="noopener noreferrer">Secrets Store CSI Driver</a></li>
</ul>
<div class="theme-admonition theme-admonition-important admonition_w9oP alert alert--info"><div class=admonitionHeading_aHcJ><span class=admonitionIcon_VWzO><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg></span>important</div><div class=admonitionContent_bAd8><p>Check if the namespace already contains a <code>SecretProviderClass</code> before creating a new one.<br>
<!-- -->Running the following command:<div class="language-sh codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-sh codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class=codeBlockLines_bXcE><span class=token-line style=color:#EEFFFF><span class="token plain">kubectl get secretproviderclass --namespace &lt;namespace></span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div><p>you should see a message like <code>No resources found in &lt;namespace> namespace.</code><p>Otherwise the <code>SecretProviderClass</code> already exists and you can directly
<a href=#add-kv-secrets-into-the-secretproviderclass>add a new secret</a>.</div></div>
<p>This is a basic <code>SecretProviderClass</code> manifest:</p>
<div class="language-yaml codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockTitle_eJuF>spc.yaml</div><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-yaml codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class=codeBlockLines_bXcE><span class=token-line style=color:#EEFFFF><span class="token key atrule" style=color:#c792ea>apiVersion</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> secrets</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">store.csi.x</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">k8s.io/v1</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>kind</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> SecretProviderClass</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>metadata</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> &lt;name</span><span class="token punctuation" style=color:#89ddff>></span><span class="token plain">                  </span><span class="token comment" style=color:#545454;font-style:italic># a recommended name convention is "&lt;namespace>-spc"</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>namespace</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> &lt;namespace</span><span class="token punctuation" style=color:#89ddff>></span><span class="token plain">        </span><span class="token comment" style=color:#545454;font-style:italic># if not specified, the default k8s namespace is "default"</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>spec</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>provider</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> azure</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>parameters</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>usePodIdentity</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'false'</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>useVMManagedIdentity</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'true'</span><span class="token plain">                                    </span><span class="token comment" style=color:#545454;font-style:italic># Set to true for using managed identity</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>userAssignedIdentityID</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx'</span><span class="token plain">  </span><span class="token comment" style=color:#545454;font-style:italic># Set the clientID of the managed identity to use</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>tenantId</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx'</span><span class="token plain">                </span><span class="token comment" style=color:#545454;font-style:italic># The tenant ID of the key vault</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>keyvaultName</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'kv-polinetwork'</span><span class="token plain">                                  </span><span class="token comment" style=color:#545454;font-style:italic># Set to the name of your key vault</span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>A few things to note:</p>
<ul>
<li><code>usePodIdentity</code> should be set to <code>false</code> and <code>useVMManagedIdentity</code> should be set to <code>true</code> since we are using a VM managed identity.</li>
<li><code>userAssignedIdentityID</code> should be set to the client ID of the managed identity we linked to the key vault.</li>
<li><code>tenantId</code> should be set to the tenant ID of our Azure tenant.</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_w9oP alert alert--success"><div class=admonitionHeading_aHcJ><span class=admonitionIcon_VWzO><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>tip</div><div class=admonitionContent_bAd8><p>If you are unsure about what the <code>userAssignedIdentityID</code> and <code>tenantId</code> are, you probably aren't one of the heads of IT in PoliNetwork.<br>
<!-- -->Changes to such parts of the manifest should only be done by someone with the right permissions.<p>Anyway here's how to get them:<ul>
<li><code>tenantId</code></li>
</ul><div class="language-sh codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-sh codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class=codeBlockLines_bXcE><span class=token-line style=color:#EEFFFF><span class="token plain">az account show --query tenantId --output tsv</span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div><ul>
<li><code>userAssignedIdentityID</code></li>
</ul><div class="language-sh codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-sh codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class=codeBlockLines_bXcE><span class=token-line style=color:#EEFFFF><span class="token plain">az aks show --resource-group &lt;resource-group> --name &lt;cluster-name> --query addonProfiles.azureKeyvaultSecretsProvider.identity.clientId -o tsv</span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div><p><code>&lt;resource-group></code> and <code>&lt;cluster-name></code> can be found both in our <a href=https://github.com/PoliNetworkOrg/terraform/ target=_blank rel="noopener noreferrer">Terraform</a> or in the Azure Portal.</div></div>
<h3 class="anchor anchorWithStickyNavbar_W4sa" id=add-kv-secrets-into-the-secretproviderclass>Add "KV" secrets into the <code>SecretProviderClass</code><a href=#add-kv-secrets-into-the-secretproviderclass class=hash-link aria-label="Direct link to add-kv-secrets-into-the-secretproviderclass" title="Direct link to add-kv-secrets-into-the-secretproviderclass">​</a></h3>
<p>Inside the <code>SecretProviderClass</code> manifest, add "KV" secrets:</p>
<div class="language-yaml codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockTitle_eJuF>spc.yaml</div><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-yaml codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class=codeBlockLines_bXcE><span class=token-line style=color:#EEFFFF><span class="token key atrule" style=color:#c792ea>apiVersion</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> secrets</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">store.csi.x</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">k8s.io/v1</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>kind</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> SecretProviderClass</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>metadata</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> &lt;name</span><span class="token punctuation" style=color:#89ddff>></span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>namespace</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> &lt;namespace</span><span class="token punctuation" style=color:#89ddff>></span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>spec</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>provider</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> azure</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>parameters</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>usePodIdentity</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'false'</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>useVMManagedIdentity</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'true'</span><span class="token plain">                                   </span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>userAssignedIdentityID</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx'</span><span class="token plain"> </span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>tenantId</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx'</span><span class="token plain">               </span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>keyvaultName</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'kv-polinetwork'</span><span class="token plain">                                 </span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>objects</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#89ddff>|</span><span class="token scalar string" style=color:#c3e88d></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token scalar string" style=color:#c3e88d>      array:</span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token scalar string" style=color:#c3e88d>        - |</span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token scalar string" style=color:#c3e88d>          objectName: &lt;secret-1-key>            </span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token scalar string" style=color:#c3e88d>          objectType: secret</span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token scalar string" style=color:#c3e88d>        - |</span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token scalar string" style=color:#c3e88d>          objectName: &lt;secret-2-key>            </span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token scalar string" style=color:#c3e88d>          objectType: secret</span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>In this example, we map two secrets (<code>&lt;secret-1-key></code> and <code>&lt;secret-2-key></code>)
from the key vault <code>kv-polinetwork</code> to a volume you can mount in your pod.</p>
<h3 class="anchor anchorWithStickyNavbar_W4sa" id=mount-the-secret-volume-inside-the-pod>Mount the secret volume inside the pod<a href=#mount-the-secret-volume-inside-the-pod class=hash-link aria-label="Direct link to Mount the secret volume inside the pod" title="Direct link to Mount the secret volume inside the pod">​</a></h3>
<p>The secret must be mounted as a volume.<br>
<!-- -->Here is an example pod manifest:</p>
<div class="language-yaml codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockTitle_eJuF>my-spc-example-pod.yaml</div><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-yaml codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class=codeBlockLines_bXcE><span class=token-line style=color:#EEFFFF><span class="token key atrule" style=color:#c792ea>kind</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> Pod</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>apiVersion</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>metadata</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> my</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">spc</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">example</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">pod</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>namespace</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> &lt;namespace</span><span class="token punctuation" style=color:#89ddff>></span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>spec</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>containers</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> busybox</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>image</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> registry.k8s.io/e2e</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">test</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">images/busybox</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain">1.29</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token number" style=color:#f78c6c>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>command</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">        </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'/bin/sleep'</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">        </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'10000'</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>volumeMounts</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">        </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> secrets</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">store               </span><span class="token comment" style=color:#545454;font-style:italic># Name of the volume defined below</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>mountPath</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'/mnt/secrets-store'</span><span class="token plain">   </span><span class="token comment" style=color:#545454;font-style:italic># Path where the secrets are mounted inside the pod</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>readOnly</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token boolean important" style=color:#c792ea;font-weight:bold>true</span><span class="token plain">                    </span><span class="token comment" style=color:#545454;font-style:italic># A secret should be mounted as read-only</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>resources</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>requests</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>cpu</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> 100m</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>memory</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> 128Mi</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>limits</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>cpu</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> 250m</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>memory</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> 256Mi</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain" style=display:inline-block></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>volumes</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">    </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> secrets</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">store                        </span><span class="token comment" style=color:#545454;font-style:italic># Name of the volume - it can be whatever you want</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>csi</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>driver</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> secrets</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">store.csi.k8s.io</span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>readOnly</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token boolean important" style=color:#c792ea;font-weight:bold>true</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>volumeAttributes</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>secretProviderClass</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'&lt;namespace>-spc'</span><span class="token plain"> </span><span class="token comment" style=color:#545454;font-style:italic># The name of the SecretProviderClass</span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>After applying this manifest to the cluster, you can retrieve the secret by reading the files in the <code>/mnt/secrets-store/</code> directory (<code>mountPath</code> parameter).<br>
<!-- -->To test if everything works, try running the following command.</p>
<div class="language-sh codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-sh codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class=codeBlockLines_bXcE><span class=token-line style=color:#EEFFFF><span class="token plain">kubectl exec -it my-spc-example-pod -- cat /mnt/secrets-store/&lt;secret-1-key></span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_w9oP alert alert--success"><div class=admonitionHeading_aHcJ><span class=admonitionIcon_VWzO><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>tip</div><div class=admonitionContent_bAd8><p>More than one secret can be mounted at the same time by adding more entries in the array,
all of them can be found in the same directory, you can see them by running:<div class="language-sh codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-sh codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class=codeBlockLines_bXcE><span class=token-line style=color:#EEFFFF><span class="token plain">kubectl exec -it my-spc-example-pod -- ls /mnt/secrets-store</span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div><p>In the <a href=#add-kv-secrets-into-the-secretproviderclass>previous section</a>, we have added <code>&lt;secret-1-key></code> and <code>&lt;secret-2-key></code>.</div></div>
<h2 class="anchor anchorWithStickyNavbar_W4sa" id=loading-the-secret-inside-an-environment-variable>Loading the secret inside an Environment Variable<a href=#loading-the-secret-inside-an-environment-variable class=hash-link aria-label="Direct link to Loading the secret inside an Environment Variable" title="Direct link to Loading the secret inside an Environment Variable">​</a></h2>
<div class="theme-admonition theme-admonition-important admonition_w9oP alert alert--info"><div class=admonitionHeading_aHcJ><span class=admonitionIcon_VWzO><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg></span>important</div><div class=admonitionContent_bAd8><p>Even if you want to load the secret as an ENV variable, it's <strong>REQUIRED</strong> to follow every steps in the previous section, including
<a href=#mount-the-secret-volume-inside-the-pod>mounting the secret volume</a>.<p>You can find more about why this is the case <a href=https://github.com/kubernetes-sigs/secrets-store-csi-driver/issues/813 target=_blank rel="noopener noreferrer">here</a></div></div>
<p>To load the secret as an Environment Variable follows the following steps.</p>
<h3 class="anchor anchorWithStickyNavbar_W4sa" id=register-the-secret-as-a-k8s-secret>Register the secret as a k8s secret<a href=#register-the-secret-as-a-k8s-secret class=hash-link aria-label="Direct link to Register the secret as a k8s secret" title="Direct link to Register the secret as a k8s secret">​</a></h3>
<p>Inside the <code>ServiceProviderClass</code> manifest, add a new field <code>secretObjects</code> to create a
new k8s secret collection:</p>
<div class="language-yaml codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockTitle_eJuF>spc.yaml</div><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-yaml codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class=codeBlockLines_bXcE><span class=token-line style=color:#EEFFFF><span class="token key atrule" style=color:#c792ea>apiVersion</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> secrets</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">store.csi.x</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">k8s.io/v1</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>kind</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> SecretProviderClass</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>metadata</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> &lt;name</span><span class="token punctuation" style=color:#89ddff>></span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>namespace</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> &lt;namespace</span><span class="token punctuation" style=color:#89ddff>></span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>spec</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>provider</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> azure</span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>secretObjects</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">    </span><span class="token comment" style=color:#545454;font-style:italic># each of these is a COLLECTION of secrets.</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">    </span><span class="token comment" style=color:#545454;font-style:italic># multiple separate collections can be defined, but to identify Azure secrets from other k8s secrets,</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">    </span><span class="token comment" style=color:#545454;font-style:italic># we use a collection that contains multiple secrets (as if it were an Object in fact).</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">    </span><span class="token comment" style=color:#545454;font-style:italic># important: it only needs to be created the first time, then just add a key underneath</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">    </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#c792ea>secretName</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> azure</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">kv</span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>type</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> Opaque</span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>data</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">        </span><span class="token comment" style=color:#545454;font-style:italic># the secret that we want to expose also as k8s secret should be added here.</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">        </span><span class="token comment" style=color:#545454;font-style:italic># important to distinguish objectName (reference to "KV") from key (custom name)</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">        </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#c792ea>objectName</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> &lt;secret</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">1</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">key</span><span class="token punctuation" style=color:#89ddff>></span><span class="token plain">      </span><span class="token comment" style=color:#545454;font-style:italic># secret name inside the "KV"</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>key</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> example</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">secret             </span><span class="token comment" style=color:#545454;font-style:italic># custom k8s secret's key</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>parameters</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>usePodIdentity</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'false'</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>useVMManagedIdentity</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'true'</span><span class="token plain">                                   </span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>userAssignedIdentityID</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx'</span><span class="token plain"> </span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>tenantId</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx'</span><span class="token plain">               </span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>keyvaultName</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'kv-polinetwork'</span><span class="token plain">                                 </span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>objects</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#89ddff>|</span><span class="token scalar string" style=color:#c3e88d></span><br></span><span class=token-line style=color:#EEFFFF><span class="token scalar string" style=color:#c3e88d>      array:</span><br></span><span class=token-line style=color:#EEFFFF><span class="token scalar string" style=color:#c3e88d>        - |</span><br></span><span class=token-line style=color:#EEFFFF><span class="token scalar string" style=color:#c3e88d>          objectName: &lt;secret-1-key>            </span><br></span><span class=token-line style=color:#EEFFFF><span class="token scalar string" style=color:#c3e88d>          objectType: secret</span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_W4sa" id=use-the-secret-as-environment-variable>Use the secret as environment variable<a href=#use-the-secret-as-environment-variable class=hash-link aria-label="Direct link to Use the secret as environment variable" title="Direct link to Use the secret as environment variable">​</a></h3>
<p>After <a href=#mount-the-secret-volume-inside-the-pod>mounting the secret volume</a> and <a href=#register-the-secret-as-a-k8s-secret>configuring the k8s secret</a>,
you can add an environment variable with the secret as value reference:</p>
<div class="language-yaml codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockTitle_eJuF>my-spc-example-pod.yaml</div><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-yaml codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class=codeBlockLines_bXcE><span class=token-line style=color:#EEFFFF><span class="token key atrule" style=color:#c792ea>kind</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> Pod</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>apiVersion</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> v1</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>metadata</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> my</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">spc</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">example</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">pod</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>namespace</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> &lt;namespace</span><span class="token punctuation" style=color:#89ddff>></span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>spec</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>containers</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> busybox</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>image</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> registry.k8s.io/e2e</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">test</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">images/busybox</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain">1.29</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token number" style=color:#f78c6c>4</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>command</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">        </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'/bin/sleep'</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">        </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'10000'</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>volumeMounts</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">        </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> secrets</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">store</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>mountPath</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'/mnt/secrets-store'</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>readOnly</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token boolean important" style=color:#c792ea;font-weight:bold>true</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>env</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">        </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> EXAMPLE_SECRET </span><span class="token comment" style=color:#545454;font-style:italic># env variable name (independent from the name of the secret)</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>valueFrom</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">            </span><span class="token key atrule" style=color:#c792ea>secretKeyRef</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">              </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> azure</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">kv </span><span class="token comment" style=color:#545454;font-style:italic># k8s secret collection name</span><span class="token plain"></span><br></span><span class="token-line code-block-add-line" style=color:#EEFFFF><span class="token plain">              </span><span class="token key atrule" style=color:#c792ea>key</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> example</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">secret </span><span class="token comment" style=color:#545454;font-style:italic># secret key inside of k8s secret collection specified in the line above</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>resources</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>requests</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>cpu</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> 100m</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>memory</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> 128Mi</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>limits</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>cpu</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> 250m</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>memory</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> 256Mi</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>volumes</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">    </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> secrets</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">store</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>csi</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>driver</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> secrets</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">store.csi.k8s.io</span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>readOnly</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token boolean important" style=color:#c792ea;font-weight:bold>true</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>volumeAttributes</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#EEFFFF><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>secretProviderClass</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'&lt;namespace>-spc'</span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_W4sa" id=kv-management>"KV" management<a href=#kv-management class=hash-link aria-label='Direct link to "KV" management' title='Direct link to "KV" management'>​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_W4sa" id=add-or-update-a-secret>Add or update a secret<a href=#add-or-update-a-secret class=hash-link aria-label="Direct link to Add or update a secret" title="Direct link to Add or update a secret">​</a></h3>
<p>You can add (or update) a secret with the following command:</p>
<div class="language-sh codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-sh codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class=codeBlockLines_bXcE><span class=token-line style=color:#EEFFFF><span class="token plain">az keyvault secret set --vault-name "kv-polinetwork" --name "&lt;secret-name>" --value "&lt;secret-value>"</span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_w9oP alert alert--success"><div class=admonitionHeading_aHcJ><span class=admonitionIcon_VWzO><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>tip</div><div class=admonitionContent_bAd8><p>If the secret value is too long or you don't want to copy/paste in terminal you can use a file instead.<ol>
<li>
<p>Paste the secret value into a text file (no extension or ".txt" is valid) on a <strong>single line</strong></p>
</li>
<li>
<p>Run the following command</p>
<div class="language-sh codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-sh codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class=codeBlockLines_bXcE><span class=token-line style=color:#EEFFFF><span class="token plain">az keyvault secret set --vault-name "kv-polinetwork" --name "&lt;secret-name>" --file "&lt;filename>"</span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
</li>
</ol></div></div>
<h3 class="anchor anchorWithStickyNavbar_W4sa" id=delete-a-secret>Delete a secret<a href=#delete-a-secret class=hash-link aria-label="Direct link to Delete a secret" title="Direct link to Delete a secret">​</a></h3>
<p>You can delete a secret with the following command:</p>
<div class="language-sh codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-sh codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class=codeBlockLines_bXcE><span class=token-line style=color:#EEFFFF><span class="token plain">az keyvault secret delete --vault-name "kv-polinetwork" --name "&lt;secret-name>"</span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>After the deletion, the secret remains in a <code>Recoverable State</code> for 7 days.<br>
<!-- -->During this period the secret can be recovered with the following command:</p>
<div class="language-sh codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-sh codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class=codeBlockLines_bXcE><span class=token-line style=color:#EEFFFF><span class="token plain">az keyvault secret recover --vault-name "kv-polinetwork" --name "&lt;secret-name>"</span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<p>To <strong>permanently delete</strong> that secret, after 7 days from deletion you can run the following command:</p>
<div class="language-sh codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-sh codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class=codeBlockLines_bXcE><span class=token-line style=color:#EEFFFF><span class="token plain">az keyvault secret purge --vault-name "kv-polinetwork" --name "&lt;secret-name>"</span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_w9oP alert alert--secondary"><div class=admonitionHeading_aHcJ><span class=admonitionIcon_VWzO><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>note</div><div class=admonitionContent_bAd8><p>To <strong>update/re-set</strong> that secret, during the 7 days retention period, you must recover it first,
then run the command to update it<p>If you try to <code>set</code> a secret that has been deleted within the last 7 days without restoring it first, you get the following error:<div class="language-sh codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-sh codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class=codeBlockLines_bXcE><span class="token-line code-block-error-line" style=color:#EEFFFF><span class="token plain">(Conflict) Secret &lt;secret-name> is currently in a deleted but recoverable state, and its name cannot be reused; in this state, the secret can only be recovered or purged.</span><br></span><span class="token-line code-block-error-line" style=color:#EEFFFF><span class="token plain">Code: Conflict</span><br></span><span class="token-line code-block-error-line" style=color:#EEFFFF><span class="token plain">Message: Secret &lt;secret-name> is currently in a deleted but recoverable state, and its name cannot be reused; in this state, the secret can only be recovered or purged.</span><br></span><span class="token-line code-block-error-line" style=color:#EEFFFF><span class="token plain">Inner error: {</span><br></span><span class="token-line code-block-error-line" style=color:#EEFFFF><span class="token plain">    "code": "ObjectIsDeletedButRecoverable"</span><br></span><span class="token-line code-block-error-line" style=color:#EEFFFF><span class="token plain">}</span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_W4sa" id=examples>Examples<a href=#examples class=hash-link aria-label="Direct link to Examples" title="Direct link to Examples">​</a></h2>
<p>In this section you can find working examples.<br>
<!-- -->It is recommended to read the <a href=#basics>"Basics" section</a> to understand how it works.</p>
<div class="theme-admonition theme-admonition-note admonition_w9oP alert alert--secondary"><div class=admonitionHeading_aHcJ><span class=admonitionIcon_VWzO><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>note</div><div class=admonitionContent_bAd8><p>You still need to set <code>tenantId</code>, <code>userAssignedIdentityID</code> and secret keys to make it work.</div></div>
<h3 class="anchor anchorWithStickyNavbar_W4sa" id=minimal>Minimal<a href=#minimal class=hash-link aria-label="Direct link to Minimal" title="Direct link to Minimal">​</a></h3>
<div class="language-yaml codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockTitle_eJuF>test-secret/spc.yaml</div><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-yaml codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class="codeBlockLines_bXcE codeBlockLinesWithNumbering_zvZU"><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token key atrule" style=color:#c792ea>apiVersion</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> secrets</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">store.csi.x</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">k8s.io/v1</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>kind</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> SecretProviderClass</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>metadata</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> test</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">secret</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">spc</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>namespace</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> test</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">secret</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>spec</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>provider</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> azure</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>parameters</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>usePodIdentity</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'false'</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>useVMManagedIdentity</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'true'</span><span class="token plain">                                   </span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>userAssignedIdentityID</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx'</span><span class="token plain"> </span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>tenantId</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx'</span><span class="token plain">               </span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>keyvaultName</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'kv-polinetwork'</span><span class="token plain">                                 </span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>objects</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#89ddff>|</span><span class="token scalar string" style=color:#c3e88d></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token scalar string" style=color:#c3e88d>      array:</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token scalar string" style=color:#c3e88d>        - |</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token scalar string" style=color:#c3e88d>          objectName: &lt;secret-1-key>            </span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token scalar string" style=color:#c3e88d>          objectType: secret</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token scalar string" style=color:#c3e88d>        - |</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token scalar string" style=color:#c3e88d>          objectName: &lt;secret-2-key>            </span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token scalar string" style=color:#c3e88d>          objectType: secret</span></span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<div class="language-yaml codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockTitle_eJuF>test-secret/example-pod.yaml</div><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-yaml codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class="codeBlockLines_bXcE codeBlockLinesWithNumbering_zvZU"><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token key atrule" style=color:#c792ea>kind</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> Pod</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>apiVersion</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> v1</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>metadata</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> example</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">pod</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>namespace</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> test</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">secret</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>spec</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>containers</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">    </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> busybox</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>image</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> registry.k8s.io/e2e</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">test</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">images/busybox</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain">1.29</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token number" style=color:#f78c6c>4</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>command</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">        </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'/bin/sleep'</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">        </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'10000'</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>volumeMounts</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">        </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> secrets</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">store</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>mountPath</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'/mnt/secrets-store'</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>readOnly</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token boolean important" style=color:#c792ea;font-weight:bold>true</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>resources</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>requests</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>cpu</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> 100m</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>memory</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> 128Mi</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>limits</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>cpu</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> 250m</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>memory</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> 256Mi</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain" style=display:inline-block></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>volumes</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">    </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> secrets</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">store</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>csi</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>driver</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> secrets</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">store.csi.k8s.io</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>readOnly</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token boolean important" style=color:#c792ea;font-weight:bold>true</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>volumeAttributes</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>secretProviderClass</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'test-secret-spc'</span></span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_W4sa" id=environment-variable>Environment Variable<a href=#environment-variable class=hash-link aria-label="Direct link to Environment Variable" title="Direct link to Environment Variable">​</a></h3>
<div class="language-yaml codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockTitle_eJuF>test-secret-env/spc.yaml</div><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-yaml codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class="codeBlockLines_bXcE codeBlockLinesWithNumbering_zvZU"><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token key atrule" style=color:#c792ea>apiVersion</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> secrets</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">store.csi.x</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">k8s.io/v1</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>kind</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> SecretProviderClass</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>metadata</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> test</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">secret</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">env</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">spc</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>namespace</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> test</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">secret</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">env</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>spec</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>provider</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> azure</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>secretObjects</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">    </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#c792ea>secretName</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> azure</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">kv</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>type</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> Opaque</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>data</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">        </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#c792ea>objectName</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> &lt;secret</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">key</span><span class="token punctuation" style=color:#89ddff>></span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>key</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> example</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">secret</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>parameters</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>usePodIdentity</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'false'</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>useVMManagedIdentity</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'true'</span><span class="token plain">                                   </span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>userAssignedIdentityID</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx'</span><span class="token plain"> </span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>tenantId</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx'</span><span class="token plain">               </span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>keyvaultName</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'kv-polinetwork'</span><span class="token plain">                                 </span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">    </span><span class="token key atrule" style=color:#c792ea>objects</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#89ddff>|</span><span class="token scalar string" style=color:#c3e88d></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token scalar string" style=color:#c3e88d>      array:</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token scalar string" style=color:#c3e88d>        - |</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token scalar string" style=color:#c3e88d>          objectName: &lt;secret-key>            </span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token scalar string" style=color:#c3e88d>          objectType: secret</span></span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div>
<div class="language-yaml codeBlockContainer_by2o theme-code-block" style=--prism-color:#EEFFFF;--prism-background-color:#212121><div class=codeBlockTitle_eJuF>test-secret-env/example-pod.yaml</div><div class=codeBlockContent_cbEE><pre tabindex=0 class="prism-code language-yaml codeBlock_RHab thin-scrollbar" style=color:#EEFFFF;background-color:#212121><code class="codeBlockLines_bXcE codeBlockLinesWithNumbering_zvZU"><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token key atrule" style=color:#c792ea>kind</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> Pod</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>apiVersion</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> v1</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>metadata</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> example</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">pod</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>namespace</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> test</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">secret</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">env</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain"></span><span class="token key atrule" style=color:#c792ea>spec</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>containers</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">    </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> busybox</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>image</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> registry.k8s.io/e2e</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">test</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">images/busybox</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain">1.29</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token number" style=color:#f78c6c>4</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>command</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">        </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'/bin/sleep'</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">        </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'10000'</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>volumeMounts</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">        </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> secrets</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">store</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>mountPath</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'/mnt/secrets-store'</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>readOnly</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token boolean important" style=color:#c792ea;font-weight:bold>true</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>env</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">        </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> EXAMPLE_SECRET</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>valueFrom</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">            </span><span class="token key atrule" style=color:#c792ea>secretKeyRef</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">              </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> azure</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">kv</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">              </span><span class="token key atrule" style=color:#c792ea>key</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> example</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">secret</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>resources</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>requests</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>cpu</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> 100m</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>memory</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> 128Mi</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>limits</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>cpu</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> 250m</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>memory</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> 256Mi</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain" style=display:inline-block></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">  </span><span class="token key atrule" style=color:#c792ea>volumes</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">    </span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#c792ea>name</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> secrets</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">store</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">      </span><span class="token key atrule" style=color:#c792ea>csi</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>driver</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> secrets</span><span class="token punctuation" style=color:#89ddff>-</span><span class="token plain">store.csi.k8s.io</span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>readOnly</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token boolean important" style=color:#c792ea;font-weight:bold>true</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">        </span><span class="token key atrule" style=color:#c792ea>volumeAttributes</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_hnKc" style=color:#EEFFFF><span class=codeLineNumber_RZFn></span><span class=codeLineContent_adR9><span class="token plain">          </span><span class="token key atrule" style=color:#c792ea>secretProviderClass</span><span class="token punctuation" style=color:#89ddff>:</span><span class="token plain"> </span><span class="token string" style=color:#c3e88d>'test-secret-env-spc'</span></span><br></span></code></pre><div class=buttonGroup_UY6E><button type=button aria-label="Copy code to clipboard" title=Copy class=clean-btn><span class=copyButtonIcons_lJSP aria-hidden=true><svg viewBox="0 0 24 24" class=copyButtonIcon_CZhK><path fill=currentColor d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class=copyButtonSuccessIcon_DAz9><path fill=currentColor d=M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z /></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/polinetworkorg/docs/tree/main/docs/infrastructure/03-Guides/add-a-new-secret.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_WbRf aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_Dbky"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/preview/PoliNetworkOrg/docs/pr/32/docs/infrastructure/getting-started/k8s-basics/day-to-day/ssh><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>ssh</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/preview/PoliNetworkOrg/docs/pr/32/docs/infrastructure/Guides/deploy-a-new-app><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Deploy a New App</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_ZKJi thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#introduction class="table-of-contents__link toc-highlight">Introduction</a><li><a href=#basics class="table-of-contents__link toc-highlight">Basics</a><ul><li><a href=#add-the-secret-into-the-kv class="table-of-contents__link toc-highlight">Add the secret into the "KV"</a><li><a href=#create-the-secretproviderclass class="table-of-contents__link toc-highlight">Create the <code>SecretProviderClass</code></a><li><a href=#add-kv-secrets-into-the-secretproviderclass class="table-of-contents__link toc-highlight">Add "KV" secrets into the <code>SecretProviderClass</code></a><li><a href=#mount-the-secret-volume-inside-the-pod class="table-of-contents__link toc-highlight">Mount the secret volume inside the pod</a></ul><li><a href=#loading-the-secret-inside-an-environment-variable class="table-of-contents__link toc-highlight">Loading the secret inside an Environment Variable</a><ul><li><a href=#register-the-secret-as-a-k8s-secret class="table-of-contents__link toc-highlight">Register the secret as a k8s secret</a><li><a href=#use-the-secret-as-environment-variable class="table-of-contents__link toc-highlight">Use the secret as environment variable</a></ul><li><a href=#kv-management class="table-of-contents__link toc-highlight">"KV" management</a><ul><li><a href=#add-or-update-a-secret class="table-of-contents__link toc-highlight">Add or update a secret</a><li><a href=#delete-a-secret class="table-of-contents__link toc-highlight">Delete a secret</a></ul><li><a href=#examples class="table-of-contents__link toc-highlight">Examples</a><ul><li><a href=#minimal class="table-of-contents__link toc-highlight">Minimal</a><li><a href=#environment-variable class="table-of-contents__link toc-highlight">Environment Variable</a></ul></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class=footer__title>Docs</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/preview/PoliNetworkOrg/docs/pr/32/docs/intro>Introduction</a><li class=footer__item><a class=footer__link-item href=/preview/PoliNetworkOrg/docs/pr/32/docs/infrastructure/Introduction>Infrastructure</a><li class=footer__item><a class=footer__link-item href=/preview/PoliNetworkOrg/docs/pr/32/docs/app>Polifemo (deprecated)</a></ul></div><div class="col footer__col"><div class=footer__title>Main Links</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://polinetwork.org target=_blank rel="noopener noreferrer" class=footer__link-item>Main Site<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_JuDX><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://github.com/polinetworkorg target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_JuDX><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div><div class="col footer__col"><div class=footer__title>Community</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://t.me/poligruppo target=_blank rel="noopener noreferrer" class=footer__link-item>Main Telegram Group<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_JuDX><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://t.me/+C2Qb3SVo5qQwMzRk target=_blank rel="noopener noreferrer" class=footer__link-item>Projects Telegram Group<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_JuDX><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a><li class=footer__item><a href=https://www.instagram.com/polinetwork_/ target=_blank rel="noopener noreferrer" class=footer__link-item>Instagram<svg width=13.5 height=13.5 aria-hidden=true viewBox="0 0 24 24" class=iconExternalLink_JuDX><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=margin-bottom--sm><a href=https://polinetwork.org rel="noopener noreferrer" class=footerLogoLink_v2_T><img src=/preview/PoliNetworkOrg/docs/pr/32/img/logo.png alt="PoliNetwork Logo" class="footer__logo themedComponent_zUZC themedComponent--light_CT2v" height=100px><img src=/preview/PoliNetworkOrg/docs/pr/32/img/logo.png alt="PoliNetwork Logo" class="footer__logo themedComponent_zUZC themedComponent--dark_OfKI" height=100px></a></div><div class=footer__copyright>Copyright © 2025 PoliNetwork APS - Built with Docusaurus</div></div></div></footer></div>